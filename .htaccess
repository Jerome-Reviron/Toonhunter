# ---------------------------------------------------------

# Sécurité globale du projet (RACINE)

# ---------------------------------------------------------

# Désactiver l’indexation des dossiers

Options -Indexes

# Rediriger les erreurs 404 vers une page sécurisée (API)

ErrorDocument 404 /api/error.php

# ---------------------------------------------------------

# Protection des fichiers sensibles

# ---------------------------------------------------------

# Bloquer l’accès aux fichiers .env

<FilesMatch "^\.env">
Order allow,deny
Deny from all
</FilesMatch>

# Bloquer les fichiers PEM / KEY (clés privées)

<FilesMatch "\.(pem|key)$">
Order allow,deny
Deny from all
</FilesMatch>

# Bloquer les JSON sensibles (clé Gemini)

<FilesMatch "gen-lang-client-.\*\.json$">
Order allow,deny
Deny from all
</FilesMatch>

# Bloquer tous les .json sauf si explicitement autorisés

<FilesMatch "\.json$">
Order allow,deny
Deny from all
</FilesMatch>

# Bloquer les fichiers de backup / archives

<FilesMatch "\.(bak|old|zip|tar|gz|sql|7z)$">
Order allow,deny
Deny from all
</FilesMatch>

# Bloquer les fichiers Git

<Files ".gitignore">
Order allow,deny
Deny from all
</Files>

# ---------------------------------------------------------

# Protection des fichiers inutiles pour une API privée

# ---------------------------------------------------------

# Bloquer robots.txt

<Files "robots.txt">
Order allow,deny
Deny from all
</Files>

# Bloquer sitemap.xml

<Files "sitemap.xml">
Order allow,deny
Deny from all
</Files>

# ---------------------------------------------------------

# Protection des fichiers PHP internes

# ---------------------------------------------------------

# Bloquer les fichiers internes non destinés à être appelés directement

<FilesMatch "^(db|cors|error|config|init)\.php$">
Order allow,deny
Deny from all
</FilesMatch>

# ---------------------------------------------------------

# Protection du dossier vendor

# ---------------------------------------------------------

# Bloquer l'accès complet au dossier vendor

RedirectMatch 404 ^/vendor/.\*$

# ---------------------------------------------------------

# Protection des fichiers Composer

# ---------------------------------------------------------

<FilesMatch "^(composer\.json|composer\.lock)$">
Order allow,deny
Deny from all
</FilesMatch>

# ---------------------------------------------------------

# Protection des dossiers internes (si présents)

# ---------------------------------------------------------

# Bloquer un éventuel dossier private

RedirectMatch 404 ^/private/.\*$

# Bloquer un éventuel dossier src côté backend

RedirectMatch 404 ^/src/.\*$
